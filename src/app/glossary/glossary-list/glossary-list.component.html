<div class="page-header-container">
  <h1>Cocktail Glossary</h1>
  <h2>Unlock the Language of Mixology: Terms, Techniques &amp; Definitions</h2>
  <p class="page-subtitle">
    Welcome to our comprehensive <b>Cocktail Glossary</b>! Whether you're a
    seasoned mixologist or just starting your journey, this is your go-to
    resource for understanding all the essential
    <b>cocktail terms, techniques, and spirits definitions</b>. Use the search
    bar and category filters to easily find what you need and deepen your
    knowledge of the fascinating world of mixology.
  </p>
</div>

<!-- SEARCH -->
<div class="search-bar-container">
  <div class="custom-search-input-wrapper">
    <input
      type="text"
      class="custom-search-input"
      placeholder="Search terms..."
      [(ngModel)]="searchTerm"
      (input)="onSearchTermChange()"
      aria-label="Search glossary terms"
      autocomplete="off"
      autocorrect="off"
      autocapitalize="off"
      spellcheck="false"
      inputmode="search"
      enterkeyhint="search"
    />
    <mat-icon
      class="clear-search-icon"
      *ngIf="searchTerm"
      (click)="clearFilters(); searchTerm = ''"
      aria-hidden="true"
      >close</mat-icon
    >
    <mat-icon class="search-icon" aria-hidden="true">search</mat-icon>
  </div>
</div>

<!-- FILTERS -->
<div class="filters-accordion" [class.expanded]="isExpanded">
  <div class="accordion-header" (click)="toggleExpansion()">
    <h3 class="accordion-title">
      <mat-icon class="accordion-icon" aria-hidden="true">filter_list</mat-icon>
      Filters
    </h3>
    <span class="active-filters-summary" *ngIf="!isExpanded">
      ({{ getActiveFiltersText() }})
    </span>
  </div>

  <div
    class="accordion-content"
    [@accordionAnimation]="isExpanded ? 'open' : 'closed'"
  >
    <div class="accordion-content-wrapper">
      <div class="filter-group">
        <label for="category-select" class="filter-label">Category</label>
        <div class="custom-select-wrapper">
          <select
            id="category-select"
            class="custom-select"
            [(ngModel)]="selectedCategory"
            (change)="applyFilters()"
            (click)="$event.stopPropagation()"
            aria-label="Filter by category"
          >
            <option value="">All Categories</option>
            <option
              *ngFor="let category of categories$ | async"
              [value]="category"
            >
              {{ category }}
            </option>
          </select>
          <mat-icon class="select-arrow-icon" aria-hidden="true"
            >arrow_drop_down</mat-icon
          >
        </div>
      </div>

      <div class="filter-group filter-button-row">
        <button class="glass-button secondary" (click)="clearFilters()">
          <mat-icon aria-hidden="true">clear_all</mat-icon>
          Clear Filters
        </button>
      </div>
    </div>
  </div>
</div>

<!-- STATUS ALERT (green, bouncing arrows) -->
<div
  *ngIf="!error"
  class="results-alert success bouncy"
  role="status"
  aria-live="polite"
>
  <ng-container *ngIf="loading; else countsLoadedGLOSS">
    <mat-icon class="status-icon spinner" aria-hidden="true">search</mat-icon>
    <span>Searching terms…</span>
  </ng-container>

  <ng-template #countsLoadedGLOSS>
    <div class="arrows" aria-hidden="true">
      <mat-icon>arrow_drop_down</mat-icon>
      <mat-icon>arrow_drop_down</mat-icon>
      <mat-icon>arrow_drop_down</mat-icon>
    </div>

    <span class="status-text">
      <b>{{ totalItems }}</b>
      {{ totalItems === 1 ? "term" : "terms" }} found
      <ng-container *ngIf="getActiveFiltersText() !== 'No filters active'">
        — filters: <b>{{ getActiveFiltersText() }}</b>
      </ng-container>
    </span>

    <div class="arrows" aria-hidden="true">
      <mat-icon>arrow_drop_down</mat-icon>
      <mat-icon>arrow_drop_down</mat-icon>
      <mat-icon>arrow_drop_down</mat-icon>
    </div>
  </ng-template>
</div>

<hr />

<!-- STATUS -->
<div
  class="page-status"
  *ngIf="!loading && !error && totalItems > 0"
  role="status"
  aria-live="polite"
>
  <span class="page-status__page"
    >Page {{ currentPage }} of {{ totalPages }}</span
  >
  <span class="page-status__sep" aria-hidden="true">•</span>
  <span class="page-status__range">
    Showing {{ pageStart }}–{{ pageEnd }} of {{ totalItems }}
  </span>
</div>

<!-- LOADING / ERROR -->
<div *ngIf="loading" class="loading-message">Loading terms...</div>
<div *ngIf="error" class="error-message">{{ error }}</div>

<!-- GRID + ADS (slot ogni adInterval) -->
<div
  class="glossary-grid-container"
  *ngIf="!loading && !error && visibleTerms.length > 0"
>
  <ng-container
    *ngFor="let term of visibleTerms; let i = index; trackBy: trackByTermId"
  >
    <app-glossary-card [term]="term"></app-glossary-card>

    <!-- slot adv ogni N card -->
    <ng-container *ngIf="i > 0 && (i + 1) % adInterval === 0">
      <div
        *ngIf="isMobile"
        class="mobile-ad-container glossary-card"
        role="complementary"
        aria-label="Sponsored content"
      >
        <span class="ad-badge">Ad</span>
        <app-dev-ads [type]="'mobile-banner'"></app-dev-ads>
      </div>

      <div
        class="ad-desktop-card glossary-card"
        *ngIf="!isMobile"
        role="complementary"
        aria-label="Sponsored content"
      >
        <span class="ad-badge">Ad</span>
        <app-dev-ads [type]="'square'"></app-dev-ads>
      </div>
    </ng-container>
  </ng-container>
</div>

<div
  *ngIf="!loading && !error && visibleTerms.length === 0"
  class="no-results-message"
>
  No terms found with the selected filters.
</div>

<!-- PAGINATION (identico a IngredientList) -->
<div class="pagination-container" *ngIf="!loading && totalPages > 1">
  <div class="pagination-controls">
    <!-- Prev: sempre visibile -->
    <ng-container *ngIf="currentPage > 1; else prevDisabledGLOSS">
      <a
        [attr.href]="buildUrlWithParams({ page: currentPage - 1 })"
        class="page-number nav-arrow"
        aria-label="Go to previous page"
        (click)="$event.preventDefault(); goToPage(currentPage - 1)"
      >
        <mat-icon aria-hidden="true">chevron_left</mat-icon>
      </a>
    </ng-container>
    <ng-template #prevDisabledGLOSS>
      <span
        class="page-number nav-arrow disabled"
        aria-disabled="true"
        aria-label="Previous page (disabled)"
      >
        <mat-icon aria-hidden="true">chevron_left</mat-icon>
      </span>
    </ng-template>

    <!-- Pagine -->
    <div class="page-numbers" role="navigation" aria-label="Pagination">
      <!-- Prima pagina -->
      <ng-container *ngIf="totalPages > 1">
        <span
          *ngIf="currentPage === 1"
          class="page-number active"
          aria-current="page"
        >
          1
        </span>
        <a
          *ngIf="currentPage !== 1"
          [attr.href]="buildUrlWithParams({ page: 1 })"
          class="page-number"
          (click)="$event.preventDefault(); goToPage(1)"
        >
          1
        </a>
      </ng-container>

      <!-- Ellissi sinistra -->
      <span *ngIf="showFirstEllipsis()" class="ellipsis" aria-hidden="true"
        >…</span
      >

      <!-- Pagine centrali -->
      <ng-container *ngFor="let page of getVisiblePages()">
        <span
          *ngIf="page === currentPage"
          class="page-number active"
          aria-current="page"
        >
          {{ page }}
        </span>
        <a
          *ngIf="page !== currentPage"
          [attr.href]="buildUrlWithParams({ page: page })"
          class="page-number"
          (click)="$event.preventDefault(); goToPage(page)"
        >
          {{ page }}
        </a>
      </ng-container>

      <!-- Ellissi destra -->
      <span *ngIf="showLastEllipsis()" class="ellipsis" aria-hidden="true"
        >…</span
      >

      <!-- Ultima pagina -->
      <ng-container *ngIf="totalPages > 1">
        <span
          *ngIf="currentPage === totalPages"
          class="page-number active"
          aria-current="page"
        >
          {{ totalPages }}
        </span>
        <a
          *ngIf="currentPage !== totalPages"
          [attr.href]="buildUrlWithParams({ page: totalPages })"
          class="page-number"
          (click)="$event.preventDefault(); goToPage(totalPages)"
        >
          {{ totalPages }}
        </a>
      </ng-container>
    </div>

    <!-- Next: sempre visibile -->
    <ng-container *ngIf="currentPage < totalPages; else nextDisabledGLOSS">
      <a
        [attr.href]="buildUrlWithParams({ page: currentPage + 1 })"
        class="page-number nav-arrow"
        aria-label="Go to next page"
        (click)="$event.preventDefault(); goToPage(currentPage + 1)"
      >
        <mat-icon aria-hidden="true">chevron_right</mat-icon>
      </a>
    </ng-container>
    <ng-template #nextDisabledGLOSS>
      <span
        class="page-number nav-arrow disabled"
        aria-disabled="true"
        aria-label="Next page (disabled)"
      >
        <mat-icon aria-hidden="true">chevron_right</mat-icon>
      </span>
    </ng-template>
  </div>
</div>

<!-- Blocchi adv fuori dalla lista -->
<ng-container>
  <div
    *ngIf="isMobile"
    class="mobile-ad-container"
    role="complementary"
    aria-label="Sponsored content"
  >
    <span class="ad-badge">Ad</span>
    <app-dev-ads [type]="'mobile-banner'"></app-dev-ads>
  </div>

  <div
    class="ad-desktop-card"
    *ngIf="!isMobile"
    role="complementary"
    aria-label="Sponsored content"
  >
    <span class="ad-badge">Ad</span>
    <app-dev-ads [type]="'leaderboard'"></app-dev-ads>
  </div>
</ng-container>

<!-- FEATURE BOX -->
<div class="key-features-section">
  <h3>Why Explore Our Cocktail Glossary?</h3>
  <div class="feature-item">
    <span class="feature-icon">📚</span>
    <p>
      <b>Comprehensive Definitions:</b> Find clear, concise explanations for
      hundreds of cocktail-related terms, from basic to obscure.
    </p>
  </div>
  <div class="feature-item">
    <span class="feature-icon">✨</span>
    <p>
      <b>Master Techniques:</b> Understand the methods behind crafting perfect
      drinks, such as 'Muddling', 'Shaking', and 'Stirring'.
    </p>
  </div>
  <div class="feature-item">
    <span class="feature-icon">🍸</span>
    <p>
      <b>Demystify Ingredients:</b> Learn about different spirits, liqueurs, and
      mixers, and how they contribute to a cocktail's profile.
    </p>
  </div>
  <div class="feature-item">
    <span class="feature-icon">🎓</span>
    <p>
      <b>Enhance Your Mixology Skills:</b> Build your knowledge and confidence
      to create, order, and discuss cocktails like a pro.
    </p>
  </div>
</div>

<!-- FAQ + Banner laterale (identico schema IngredientList) -->
@defer (on viewport) {
<div class="bottom-container">
  <div class="faq-section">
    <h2>Frequently Asked Questions about the Cocktail Glossary</h2>

    <div class="faq-item" [class.expanded]="faqs[0].isExpanded">
      <h3 class="faq-question" (click)="toggleFaq(faqs[0])">
        What kind of terms can I find in the Cocktail Glossary?
        <mat-icon class="faq-toggle-icon" [class.rotated]="faqs[0].isExpanded"
          >expand_more</mat-icon
        >
      </h3>
      <div
        class="faq-answer-wrapper"
        [@accordionAnimation]="faqs[0].isExpanded ? 'open' : 'closed'"
      >
        <p class="faq-answer">
          Our Cocktail Glossary includes a wide range of terms, from common
          cocktail ingredients and bar tools to advanced mixology techniques,
          historical definitions, and types of drinks.
        </p>
      </div>
    </div>

    <div class="faq-item" [class.expanded]="faqs[1].isExpanded">
      <h3 class="faq-question" (click)="toggleFaq(faqs[1])">
        How can I search for a specific term?
        <mat-icon class="faq-toggle-icon" [class.rotated]="faqs[1].isExpanded"
          >expand_more</mat-icon
        >
      </h3>
      <div
        class="faq-answer-wrapper"
        [@accordionAnimation]="faqs[1].isExpanded ? 'open' : 'closed'"
      >
        <p class="faq-answer">
          You can use the search bar at the top of the glossary page. Simply
          type in the term you are looking for, and the results will filter
          automatically as you type.
        </p>
      </div>
    </div>

    <div class="faq-item" [class.expanded]="faqs[2].isExpanded">
      <h3 class="faq-question" (click)="toggleFaq(faqs[2])">
        Can I filter terms by category?
        <mat-icon class="faq-toggle-icon" [class.rotated]="faqs[2].isExpanded"
          >expand_more</mat-icon
        >
      </h3>
      <div
        class="faq-answer-wrapper"
        [@accordionAnimation]="faqs[2].isExpanded ? 'open' : 'closed'"
      >
        <p class="faq-answer">
          Yes, you can! Open the <b>"Filters"</b> section by clicking on it.
          There's a dropdown menu for <b>"Category"</b> where you can select
          specific categories like <b>"Techniques"</b>, <b>"Spirits"</b>,
          <b>"Garnish"</b>, etc., to narrow down your search.
        </p>
      </div>
    </div>

    <div class="faq-item" [class.expanded]="faqs[3].isExpanded">
      <h3 class="faq-question" (click)="toggleFaq(faqs[3])">
        What if I can't find a term I'm looking for?
        <mat-icon class="faq-toggle-icon" [class.rotated]="faqs[3].isExpanded"
          >expand_more</mat-icon
        >
      </h3>
      <div
        class="faq-answer-wrapper"
        [@accordionAnimation]="faqs[3].isExpanded ? 'open' : 'closed'"
      >
        <p class="faq-answer">
          While our glossary is comprehensive, it's always growing. If you can't
          find a specific term, please visit our Contact Us page with your
          suggestion! We're always happy to expand our resources.
        </p>
      </div>
    </div>

    <div class="faq-item" [class.expanded]="faqs[4].isExpanded">
      <h3 class="faq-question" (click)="toggleFaq(faqs[4])">
        How often is the glossary updated?
        <mat-icon class="faq-toggle-icon" [class.rotated]="faqs[4].isExpanded"
          >expand_more</mat-icon
        >
      </h3>
      <div
        class="faq-answer-wrapper"
        [@accordionAnimation]="faqs[4].isExpanded ? 'open' : 'closed'"
      >
        <p class="faq-answer">
          We regularly review and update our glossary to ensure accuracy and to
          add new terms as they emerge in the world of cocktails. Our goal is to
          keep it a relevant and valuable resource for all enthusiasts.
        </p>
      </div>
    </div>
  </div>

  <div
    class="banner-container"
    role="complementary"
    aria-label="Sponsored content"
  >
    <div class="banner-content">
      <span class="ad-badge">Ad</span>
      <ng-container>
        <app-dev-ads *ngIf="isMobile" [type]="'mobile-banner'"></app-dev-ads>
        <app-dev-ads *ngIf="!isMobile" [type]="'half-page'"></app-dev-ads>
      </ng-container>
    </div>
  </div>
</div>
} @placeholder {
<div class="bottom-container placeholder" aria-hidden="true">
  <div class="faq-section skeleton"></div>
  <div class="banner-container skeleton"></div>
</div>
}
