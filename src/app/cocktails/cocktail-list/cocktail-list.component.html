<div class="page-header-container" [class.fonts-loaded]="fontsLoaded">
  <h1>Cocktail Explorer</h1>
  <h2>Your Ultimate Cocktail Guide: Search, Filter, and Discover New Drinks</h2>

  <p class="page-subtitle">
    Welcome to <b>Fizzando’s definitive cocktail archive</b>! Whether you're a
    seasoned bartender or an enthusiast looking for new inspiration, here you’ll
    find <b>hundreds of cocktail recipes</b>—from <b>timeless classics</b> to
    <b>innovative creations</b> and <b>exotic drinks</b> from around the world.
  </p>
</div>

<!-- SEARCH (senza FormsModule) -->
<div class="custom-search-input-wrapper">
  <input
    type="search"
    class="custom-search-input"
    placeholder="Search cocktails by name..."
    [value]="searchTerm()"
    (input)="onSearchInput($event)"
    aria-label="Search cocktails by name"
  />
  <mat-icon
    class="clear-search-icon"
    *ngIf="searchTerm()"
    (click)="clearFilters(); setSearch('')"
    svgIcon="close"
    aria-label="Clear search"
  ></mat-icon>
  <mat-icon class="search-icon" svgIcon="search" aria-hidden="true"></mat-icon>
</div>

<!-- FILTERS -->
<div class="filters-accordion" [class.expanded]="isExpanded()">
  <div class="accordion-header" (click)="toggleExpansion()">
    <h3 class="accordion-title">
      <mat-icon
        class="accordion-icon"
        svgIcon="filter_list"
        aria-hidden="true"
      ></mat-icon>
      Filters
    </h3>
    <span class="active-filters-summary" *ngIf="!isExpanded()">
      ({{ getActiveFiltersText() }})
    </span>
  </div>

  @defer (when isExpanded()) {
  <div class="accordion-content">
    <div class="filter-group">
      <label for="category-select" class="filter-label">Category</label>
      <div class="custom-select-wrapper">
        <select
          id="category-select"
          class="custom-select"
          [value]="selectedCategory()"
          (change)="onCategoryChange($event)"
          (click)="$event.stopPropagation()"
          aria-label="Filter by category"
        >
          <option value="">All Categories</option>
          <option *ngFor="let category of categories" [value]="category">
            {{ category }}
          </option>
        </select>
        <mat-icon
          class="select-arrow-icon"
          svgIcon="arrow_drop_down"
          aria-hidden="true"
        ></mat-icon>
      </div>
    </div>

    <div class="filter-group">
      <label for="alcoholic-select" class="filter-label"
        >Alcoholic / Non-Alcoholic</label
      >
      <div class="custom-select-wrapper">
        <select
          id="alcoholic-select"
          class="custom-select"
          [value]="selectedAlcoholic()"
          (change)="onAlcoholicChange($event)"
          (click)="$event.stopPropagation()"
          aria-label="Filter by alcoholic type"
        >
          <option value="">All</option>
          <option *ngFor="let option of alcoholicOptions" [value]="option">
            {{ option }}
          </option>
        </select>
        <mat-icon
          class="select-arrow-icon"
          svgIcon="arrow_drop_down"
          aria-hidden="true"
        ></mat-icon>
      </div>
    </div>

    <div class="filter-group filter-button-row">
      <button
        class="glass-button secondary"
        (click)="clearFilters()"
        aria-label="Clear all filters"
      >
        <mat-icon svgIcon="clear_all" aria-hidden="true"></mat-icon>
        Clear Filters
      </button>
    </div>
  </div>
  }
</div>

<hr />

<p class="cocktail-card-legend">
  Each card shows the cocktail’s <b>image</b>, <b>category</b>, estimated
  <b>ABV (Alcohol By Volume)</b>, <b>key ingredients</b>, and the
  <b>recommended glass</b>. Click a cocktail to view full details!
</p>

<div *ngIf="loading" class="loading-message">Loading cocktails...</div>
<div *ngIf="error" class="error-message">{{ error }}</div>

<div class="cocktail-list" *ngIf="!error && cocktails.length > 0">
  <ng-container
    *ngFor="
      let cocktail of cocktails;
      let i = index;
      trackBy: trackByCocktailId
    "
  >
    <app-cocktail-card
      [cocktail]="cocktail"
      [isLcp]="i === 0"
    ></app-cocktail-card>

    <ng-container *ngIf="i > 0 && (i + 1) % 6 === 0">
      <div
        *ngIf="isMobile"
        class="mobile-ad-container"
        role="complementary"
        aria-label="Sponsored content"
      >
        <span class="ad-badge">Ad</span>
        <app-dev-ads [type]="'mobile-banner'"></app-dev-ads>
      </div>

      <div
        class="ad-desktop-card"
        *ngIf="!isMobile"
        role="complementary"
        aria-label="Sponsored content"
      >
        <span class="ad-badge">Ad</span>
        <app-dev-ads [type]="'square'"></app-dev-ads>
      </div>
    </ng-container>
  </ng-container>
</div>

<div class="no-results-message" *ngIf="!loading && !cocktails.length">
  <p>No cocktails match your criteria. Try adjusting your filters!</p>
</div>

<div class="pagination-container" *ngIf="!loading && totalPages > 1">
  <div class="pagination-controls">
    <button
      class="glass-button secondary"
      [disabled]="currentPage === 1"
      (click)="goToPage(currentPage - 1)"
      aria-label="Go to previous page"
    >
      Previous
    </button>

    <div class="page-numbers" role="navigation" aria-label="Pagination">
      <a
        *ngIf="showFirstPage()"
        [routerLink]="[]"
        [queryParams]="{ page: 1 }"
        queryParamsHandling="merge"
        class="page-number"
        [ngClass]="{ active: currentPage === 1 }"
        (click)="goToPage(1)"
      >
        1
      </a>
      <span *ngIf="showFirstEllipsis()" class="ellipsis" aria-hidden="true"
        >...</span
      >

      <ng-container *ngFor="let page of getVisiblePages()">
        <a
          [routerLink]="[]"
          [queryParams]="{ page: page }"
          queryParamsHandling="merge"
          class="page-number"
          [ngClass]="{ active: currentPage === page }"
          (click)="goToPage(page)"
        >
          {{ page }}
        </a>
      </ng-container>

      <span *ngIf="showLastEllipsis()" class="ellipsis" aria-hidden="true"
        >...</span
      >
      <a
        *ngIf="showLastPage()"
        [routerLink]="[]"
        [queryParams]="{ page: totalPages }"
        queryParamsHandling="merge"
        class="page-number"
        [ngClass]="{ active: currentPage === totalPages }"
        (click)="goToPage(totalPages)"
      >
        {{ totalPages }}
      </a>
    </div>

    <button
      class="glass-button secondary"
      [disabled]="currentPage === totalPages"
      (click)="goToPage(currentPage + 1)"
      aria-label="Go to next page"
    >
      Next
    </button>
  </div>
</div>

<section class="glass-card">
  <h2 class="section-title">🛒 Craft Cocktails with the Right Tools</h2>
  @defer (on viewport) {
  <div class="affiliate-card-list" #affiliateCardList>
    <div class="scrollerdiv">
      <ng-container *ngFor="let product of productList; let i = index">
        <div class="aff-item">
          <app-affiliate-product
            [title]="product.title"
            [imageUrl]="product.imageUrl"
            [price]="product.price"
            [link]="product.link"
            [showPlaceholder]="product.showPlaceholder"
          >
          </app-affiliate-product>
        </div>
      </ng-container>
    </div>
  </div>
  } @placeholder {
  <div class="affiliate-card-list placeholder" aria-hidden="true">
    <div class="scrollerdiv">
      <div class="aff-item skeleton"></div>
      <div class="aff-item skeleton"></div>
      <div class="aff-item skeleton"></div>
    </div>
  </div>
  }
  <p class="affiliate-bottom">
    We may receive a small commission if you purchase through these links — it
    helps keep the shaker shaking! 🙌🍸
  </p>
</section>

<div class="key-features-section">
  <h3>Why use Fizzando to explore cocktails?</h3>
  <div class="feature-item">
    <span class="feature-icon">📚</span>
    <p>
      <b>Comprehensive Details:</b> Each cocktail includes step-by-step
      instructions, precise measurements, origin stories, sensory descriptions,
      food pairings, ideal occasions, and variations.
    </p>
  </div>
  <div class="feature-item">
    <span class="feature-icon">📦</span>
    <p>
      <b>Discover Ingredients:</b> Explore our
      <a href="/ingredients"><b>Ingredients</b></a> section to learn more about
      every component.
    </p>
  </div>
  <div class="feature-item">
    <span class="feature-icon">🧑‍🍳</span>
    <p>
      <b>Craft with What You Have:</b> Use our
      <a href="/find-by-ingredients"><b>Find by Ingredients</b></a>
      tool to discover cocktails you can make with your current stock.
    </p>
  </div>
  <div class="feature-item">
    <span class="feature-icon">🎓</span>
    <p>
      <b>Master Your Craft:</b> Deepen your cocktail knowledge with our
      <a href="/glossary"><b>Glossary</b></a> of terms and techniques.
    </p>
  </div>
</div>

@defer (on viewport) {
<div class="bottom-container">
  <div class="faq-section">
    <h2>Frequently Asked Questions about Ingredients</h2>

    <div class="faq-item" [class.expanded]="faqs[0].isExpanded">
      <button
        class="faq-question"
        type="button"
        (click)="toggleFaq(faqs[0])"
        [attr.aria-expanded]="faqs[0].isExpanded"
      >
        <span>What types of ingredients can I find here?</span>
        <mat-icon class="faq-toggle-icon" svgIcon="arrow_drop_down"></mat-icon>
      </button>
      <div
        #a0
        class="faq-answer-wrapper"
        [style.maxHeight.px]="faqs[0].isExpanded ? a0.scrollHeight : 0"
      >
        <p class="faq-answer">
          Our comprehensive ingredient database includes
          <b>alcoholic bases</b> (like spirits and liqueurs),
          <b>non-alcoholic mixers</b> (such as juices, syrups, and sodas), and
          various <b>garnishes</b>. You can use our filters to narrow down your
          search.
        </p>
      </div>
    </div>

    <div class="faq-item" [class.expanded]="faqs[1].isExpanded">
      <button
        class="faq-question"
        type="button"
        (click)="toggleFaq(faqs[1])"
        [attr.aria-expanded]="faqs[1].isExpanded"
      >
        <span>How can I search for a specific ingredient?</span>
        <mat-icon class="faq-toggle-icon" svgIcon="arrow_drop_down"></mat-icon>
      </button>
      <div
        #a1
        class="faq-answer-wrapper"
        [style.maxHeight.px]="faqs[1].isExpanded ? a1.scrollHeight : 0"
      >
        <p class="faq-answer">
          Use the <b>"Search ingredient by name..." bar</b> at the top of the
          page. Simply type the name of the ingredient you're looking for, and
          we'll help you find it quickly.
        </p>
      </div>
    </div>

    <div class="faq-item" [class.expanded]="faqs[2].isExpanded">
      <button
        class="faq-question"
        type="button"
        (click)="toggleFaq(faqs[2])"
        [attr.aria-expanded]="faqs[2].isExpanded"
      >
        <span>What information is available for each ingredient?</span>
        <mat-icon class="faq-toggle-icon" svgIcon="arrow_drop_down"></mat-icon>
      </button>
      <div
        #a2
        class="faq-answer-wrapper"
        [style.maxHeight.px]="faqs[2].isExpanded ? a2.scrollHeight : 0"
      >
        <p class="faq-answer">
          Each ingredient card displays its <b>image</b> and whether it's
          <b>alcoholic or non-alcoholic</b>. Clicking on an ingredient provides
          in-depth details such as its <b>description</b>, common
          <b>uses in cocktails</b>, its <b>origin</b>, and relevant
          <b>tips for storage or usage</b>.
        </p>
      </div>
    </div>

    <div class="faq-item" [class.expanded]="faqs[3].isExpanded">
      <button
        class="faq-question"
        type="button"
        (click)="toggleFaq(faqs[3])"
        [attr.aria-expanded]="faqs[3].isExpanded"
      >
        <span>Can I filter ingredients by alcoholic content?</span>
        <mat-icon class="faq-toggle-icon" svgIcon="arrow_drop_down"></mat-icon>
      </button>
      <div
        #a3
        class="faq-answer-wrapper"
        [style.maxHeight.px]="faqs[3].isExpanded ? a3.scrollHeight : 0"
      >
        <p class="faq-answer">
          Yes, absolutely! Use the <b>"Alcoholic / Non-Alcoholic" filter</b> to
          quickly sort ingredients based on their alcohol content.
        </p>
      </div>
    </div>

    <div class="faq-item" [class.expanded]="faqs[4].isExpanded">
      <button
        class="faq-question"
        type="button"
        (click)="toggleFaq(faqs[4])"
        [attr.aria-expanded]="faqs[4].isExpanded"
      >
        <span
          >Where can I find cocktail recipes that use these ingredients?</span
        >
        <mat-icon class="faq-toggle-icon" svgIcon="arrow_drop_down"></mat-icon>
      </button>
      <div
        #a4
        class="faq-answer-wrapper"
        [style.maxHeight.px]="faqs[4].isExpanded ? a4.scrollHeight : 0"
      >
        <p class="faq-answer">
          To discover delicious cocktails, visit our
          <b>"Cocktail Explorer"</b> section…
        </p>
      </div>
    </div>

    <div class="faq-item" [class.expanded]="faqs[5].isExpanded">
      <button
        class="faq-question"
        type="button"
        (click)="toggleFaq(faqs[5])"
        [attr.aria-expanded]="faqs[5].isExpanded"
      >
        <span>How can I find cocktails based on the ingredients I have?</span>
        <mat-icon class="faq-toggle-icon" svgIcon="arrow_drop_down"></mat-icon>
      </button>
      <div
        #a5
        class="faq-answer-wrapper"
        [style.maxHeight.px]="faqs[5].isExpanded ? a5.scrollHeight : 0"
      >
        <p class="faq-answer">
          Check out our <b>"Find by Ingredients"</b> tool…
        </p>
      </div>
    </div>
  </div>

  <div
    class="banner-container"
    role="complementary"
    aria-label="Sponsored content"
  >
    <span class="ad-badge">Ad</span>
    <ng-container>
      <app-dev-ads *ngIf="isMobile" [type]="'mobile-banner'"></app-dev-ads>
      <app-dev-ads *ngIf="!isMobile" [type]="'half-page'"></app-dev-ads>
    </ng-container>
  </div>
</div>
} @placeholder {
<div class="bottom-container placeholder" aria-hidden="true">
  <div class="faq-section skeleton"></div>
  <div class="banner-container skeleton"></div>
</div>
}
