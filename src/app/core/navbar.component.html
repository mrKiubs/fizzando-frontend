<header
  role="banner"
  class="app-header"
  appStickyHeader="fixed"
  [class.scrolled]="isScrolled"
>
  <div class="header-content">
    <app-logo [isHome]="isHome" (click)="closeMenu()"></app-logo>

    <div class="header-actions">
      <!-- Bottone SEARCH -->
      <button
        #searchTrigger
        type="button"
        class="icon-button"
        (click)="toggleSearch()"
        [attr.aria-expanded]="isSearchOpen"
        aria-controls="search-overlay"
        aria-label="Search cocktail o ingredient"
      >
        <span class="material-icons" aria-hidden="true">
          {{ isSearchOpen ? "close" : "search" }}
        </span>
      </button>

      <!-- Bottone MENU -->
      <button
        #menuToggle
        type="button"
        class="menu-toggle-button icon-button"
        (click)="toggleMenu()"
        [attr.aria-expanded]="isMenuOpen ? 'true' : 'false'"
        aria-controls="primary-navigation"
        [attr.aria-label]="isMenuOpen ? 'Close menu' : 'Open menu'"
        aria-haspopup="menu"
      >
        <span class="material-icons" aria-hidden="true">
          {{ isMenuOpen ? "close" : "menu" }}
        </span>
      </button>
    </div>
  </div>
</header>

<!-- MENU OVERLAY (hamburger) -->
<div
  #overlayRoot
  class="full-screen-menu-overlay"
  role="dialog"
  aria-modal="true"
  aria-labelledby="menu-title"
  aria-describedby="menu-hint"
  [class.open]="isMenuOpen"
  (keydown.escape)="closeMenu()"
>
  <div class="overlay-content">
    <h2 id="menu-title" class="visually-hidden">Main menu</h2>

    <div class="overlay-breadcrumbs">
      <app-breadcrumbs (linkClicked)="closeMenu()"></app-breadcrumbs>
    </div>

    <!-- NIENTE ricerca qui dentro (rimossa) -->

    <nav id="primary-navigation" role="navigation" aria-label="Primary">
      <div class="menu-grid">
        <!-- Cocktails -->
        <div
          class="menu-card cocktails-card"
          role="region"
          aria-labelledby="nav-cocktails-title"
        >
          <h3 id="nav-cocktails-title">🍸 Cocktails</h3>

          <ul>
            <li>
              <a
                routerLink="/cocktails"
                [attr.href]="'/cocktails'"
                (click)="closeMenu()"
                >🍸 Cocktails Explorer</a
              >
            </li>
            <li>
              <a
                routerLink="/cocktails"
                [queryParams]="{ alcoholic: 'Alcoholic' }"
                [attr.href]="'/cocktails?alcoholic=Alcoholic'"
                (click)="closeMenu()"
                >🥃 Alcoholic</a
              >
            </li>
            <li>
              <a
                routerLink="/cocktails"
                [queryParams]="{ alcoholic: 'Non Alcoholic' }"
                [attr.href]="'/cocktails?alcoholic=Non%20Alcoholic'"
                (click)="closeMenu()"
                >💧 Non Alcoholic</a
              >
            </li>
          </ul>

          <h4 id="nav-cocktails-cat-title">Explore by Category</h4>
          <div
            class="filter-with-button"
            aria-describedby="nav-cocktails-cat-help"
          >
            <p id="nav-cocktails-cat-help" class="visually-hidden">
              Choose a cocktail category, then press Go.
            </p>

            <div class="custom-select-wrapper">
              <label class="visually-hidden" for="cocktail-category-select"
                >Cocktail category</label
              >
              <select
                id="cocktail-category-select"
                [(ngModel)]="selectedCocktailCategory"
                class="custom-select"
              >
                <option
                  value=""
                  [attr.selected]="
                    selectedCocktailCategory === '' ? true : null
                  "
                >
                  All Categories
                </option>
                <option value="classic">🧊 Classic</option>
                <option value="tropical">🌴 Tropical</option>
                <option value="refreshing">🍃 Refreshing</option>
                <option value="aperitif">🥂 Aperitif</option>
                <option value="after-dinner">🌙 After-Dinner</option>
                <option value="sour">🍋 Sour</option>
                <option value="spirit-forward">🥃 Spirit-Forward</option>
                <option value="sparkling">✨ Sparkling</option>
                <option value="flaming">🔥 Flaming</option>
                <option value="hot">♨️ Hot</option>
                <option value="other">❓ Other</option>
              </select>
              <span class="material-icons select-arrow-icon" aria-hidden="true"
                >arrow_drop_down</span
              >
            </div>

            <button
              type="button"
              class="go-button glass-button secondary"
              [class.active]="
                selectedCocktailCategory !== '' &&
                selectedCocktailCategory !== activeCocktailCategoryInUrl
              "
              (click)="goCocktailCategory()"
              [attr.aria-label]="
                'Go to ' +
                (selectedCocktailCategory || 'All Categories') +
                ' cocktails'
              "
              aria-describedby="cocktail-category-select"
            >
              <span class="material-icons" aria-hidden="true"
                >arrow_forward</span
              >
            </button>
          </div>
        </div>

        <!-- Ingredients -->
        <div
          class="menu-card ingredients-card"
          role="region"
          aria-labelledby="nav-ingredients-title"
        >
          <h3 id="nav-ingredients-title">🍋 Ingredients</h3>

          <ul>
            <li>
              <a
                routerLink="/ingredients"
                [attr.href]="'/ingredients'"
                (click)="closeMenu()"
                >🥕 Ingredients Explorer</a
              >
            </li>
            <li>
              <a
                routerLink="/ingredients"
                [queryParams]="{ alcoholic: 'true' }"
                [attr.href]="'/ingredients?alcoholic=true'"
                (click)="closeMenu()"
                >🥃 Alcoholic Ingredients</a
              >
            </li>
            <li>
              <a
                routerLink="/ingredients"
                [queryParams]="{ alcoholic: 'false' }"
                [attr.href]="'/ingredients?alcoholic=false'"
                (click)="closeMenu()"
                >💧 Non-Alcoholic Ingredients</a
              >
            </li>
          </ul>

          <h4 id="nav-ingredients-type-title">Explore By Type</h4>
          <div
            class="filter-with-button"
            aria-describedby="nav-ingredients-type-help"
          >
            <p id="nav-ingredients-type-help" class="visually-hidden">
              Choose an ingredient type, then press Go.
            </p>

            <div class="custom-select-wrapper">
              <label class="visually-hidden" for="ingredient-type-select"
                >Ingredient type</label
              >
              <select
                id="ingredient-type-select"
                [(ngModel)]="selectedIngredientType"
                class="custom-select"
              >
                <option
                  value=""
                  [attr.selected]="selectedIngredientType === '' ? true : null"
                >
                  All Types
                </option>
                <option value="spirits">🥃 Spirits</option>
                <option value="liqueurs-and-cordials">
                  🍯 Liqueurs &amp; Cordials
                </option>
                <option value="wines-and-fortified-wines">
                  🍷 Wines &amp; Fortified Wines
                </option>
                <option value="bitters">🌿 Bitters</option>
                <option value="syrups-and-sweeteners">
                  🍬 Syrups &amp; Sweeteners
                </option>
                <option value="citrus-juices">🍋 Citrus Juices</option>
                <option value="fruit-juices-non-citrus">
                  🍎 Fruit Juices (Non-Citrus)
                </option>
                <option value="carbonated-mixers">🫧 Carbonated Mixers</option>
                <option value="non-carbonated-mixers">
                  💧 Non-Carbonated Mixers
                </option>
                <option value="fresh-herbs-and-botanicals">
                  🌱 Fresh Herbs &amp; Botanicals
                </option>
                <option value="spices">🌶️ Spices</option>
                <option value="fresh-fruits-solid-garnish">
                  🍓 Fresh Fruits (Solid/Garnish)
                </option>
                <option value="vegetables-non-herb">
                  🥕 Vegetables (Non-Herb)
                </option>
                <option value="dairy-and-eggs">🥛 Dairy &amp; Eggs</option>
                <option value="other-extracts-and-flavorings">
                  🧪 Other Extracts &amp; Flavorings
                </option>
                <option value="salts-and-sugars-rimming-specialty">
                  🧂 Salts &amp; Sugars (Rimming/Specialty)
                </option>
                <option value="miscellaneous">✨ Miscellaneous</option>
              </select>
              <span class="material-icons select-arrow-icon" aria-hidden="true"
                >arrow_drop_down</span
              >
            </div>

            <button
              type="button"
              class="go-button glass-button secondary"
              [class.active]="
                selectedIngredientType !== '' &&
                selectedIngredientType !== activeIngredientTypeInUrl
              "
              (click)="goIngredientType()"
              [attr.aria-label]="
                'Go to ' +
                (selectedIngredientType || 'All Types') +
                ' ingredients'
              "
              aria-describedby="ingredient-type-select"
            >
              <span class="material-icons" aria-hidden="true"
                >arrow_forward</span
              >
            </button>
          </div>
        </div>

        <!-- Find by Ingredients -->
        <div
          class="menu-card my-recipes-card"
          role="region"
          aria-labelledby="nav-find-title"
        >
          <h3 id="nav-find-title">🍸 + 🍋 Find Your Cocktail</h3>
          <ul>
            <li>
              <a
                routerLink="/find-cocktail"
                [attr.href]="'/find-cocktail'"
                (click)="closeMenu()"
                >🌿 Search by Ingredients</a
              >
            </li>
          </ul>
        </div>

        <!-- Glossary -->
        <div
          class="menu-card glossary-card"
          role="region"
          aria-labelledby="nav-glossary-title"
        >
          <h3 id="nav-glossary-title">📘 Glossary</h3>
          <ul>
            <li>
              <a
                routerLink="/glossary"
                [attr.href]="'/glossary'"
                (click)="closeMenu()"
                >📘 Cocktail Glossary</a
              >
            </li>
          </ul>

          <h4 id="nav-glossary-cat-title">Explore by Category</h4>
          <div
            class="filter-with-button"
            aria-describedby="nav-glossary-cat-help"
          >
            <p id="nav-glossary-cat-help" class="visually-hidden">
              Choose a glossary category, then press Go.
            </p>

            <div class="custom-select-wrapper">
              <label class="visually-hidden" for="glossary-category-select"
                >Glossary category</label
              >
              <select
                id="glossary-category-select"
                [(ngModel)]="selectedGlossaryCategory"
                class="custom-select"
              >
                <option
                  value=""
                  [attr.selected]="
                    selectedGlossaryCategory === '' ? true : null
                  "
                >
                  All Categories
                </option>
                <option *ngFor="let cat of glossaryCategories" [value]="cat">
                  {{ cat }}
                </option>
              </select>
              <span class="material-icons select-arrow-icon" aria-hidden="true"
                >arrow_drop_down</span
              >
            </div>

            <button
              type="button"
              class="go-button glass-button secondary"
              [class.active]="
                selectedGlossaryCategory !== '' &&
                selectedGlossaryCategory !== activeGlossaryCategoryInUrl
              "
              (click)="goGlossaryCategory()"
              [attr.aria-label]="
                'Go to ' +
                (selectedGlossaryCategory || 'All Categories') +
                ' glossary terms'
              "
              aria-describedby="glossary-category-select"
            >
              <span class="material-icons" aria-hidden="true"
                >arrow_forward</span
              >
            </button>
          </div>
        </div>

        <!-- Home -->
        <div
          class="menu-card home-card"
          role="region"
          aria-labelledby="nav-home-title"
        >
          <h3 id="nav-home-title">🏠 Home</h3>
          <ul>
            <li>
              <a routerLink="/" [attr.href]="'/'" (click)="closeMenu()"
                >🏠 Go to Homepage</a
              >
            </li>
            <li>
              <a
                routerLink="/about"
                [attr.href]="'/about'"
                (click)="closeMenu()"
                >ℹ️ About Us</a
              >
            </li>
          </ul>
        </div>
      </div>
    </nav>
  </div>
</div>

@defer (on idle; prefetch on interaction(searchTrigger)) {
<app-navbar-search-host
  [open]="isSearchOpen"
  (closeRequested)="onSearchCloseRequested()"
  (inertToggle)="onSearchInertToggle($event)"
></app-navbar-search-host>
} @placeholder {
<div
  id="search-overlay"
  class="search-overlay-placeholder"
  aria-hidden="true"
></div>
}
